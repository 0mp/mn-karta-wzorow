\section{LZNK}

% LZNK.
\entry
LZNK: układ $n$ równań z $m$ niewiadomymi.
Cel: $\norm{b - Ax}_2 \to \min !$;
% $\sum_i(\sum_ja_{ij}-b_i)^2 \to \min !$

% Układ równań normalnych.
\entry
U. normalny
$A^TAx=A^Tb$
jest rozw. LZNK;

% Uwarunkowanie LZNK.
\entry
Uwarunkowanie LZNK:
$\norm{\tilde{b} - \tilde{A}\tilde{x}}_2 \to \mathrm{min}!$
i $\epsilon\coloneqq \max\set{ \frac{\norm{A - \tilde{A}}_2}{\norm{A}_2}, \frac{\norm{x - \tilde{x}}_2}{\norm{x}_2} }$
tak małe, że $\mathrm{cond}_2(A)\cdot \epsilon < 1$,
gdzie $\mathrm{cond}_2(A) = \frac{\sigma_{\max(A)}}{\min(A)}$.
Wtedy zadanie ma 1 rozwiązanie i
$\frac{\norm{x-\tilde{x}}_2}{\norm{x}_2} \leq  \epsilon \cdot \mathrm{cond}_{\mathrm{LZNK}}(A,b)+ O(\epsilon^2)$,
gdzie $\mathrm{cond}_{\mathrm{LZNK}}(A,b) = \frac{2\mathrm{cond}_2(A)}{\cos\theta} + \tan\theta(\mathrm{cond}_2(A))^2$,
gdzie $\sin\theta=\frac{\norm{b-Ax}_2}{\norm{b}_2}$;

% Rozkład QR.
\entry
Rozkład QR:
$A = QR = Q_1R_1$;

% Algorytm rozwiązywania LZNK przez rozkład QR.
\entry
Rozw. LZNK przez r. QR:
\textsubentry{1}
$A=QR$;
\textsubentry{2}
$\norm{b-Ax}^2_2 = \norm{Q^T_1b-R_1x}^2_2 + \norm{\tilde{Q}^Tb}^2_2 \to \min !$;
\textsubentry{3}
Rozwiązaniem jest $x\in \mathbb{R}^m$ spełniający ukł. r-ń z macierzą trójkątną $R_1x=Q_1^Tb$.
Koszt: $O(m^2)$.
Koszt $Q_1^Tb$: $O(nm)$;

% TODO: Wyznaczanie rozkładu QR metodą Householdera.
% TODO: Definicja przekształcenia Householdera.

% Przekształcenie (metoda) Householdera.
\entry
Odbicie Householdera:
$v\in \mathbb{R}^N$,
$\gamma \coloneqq \frac{2}{\norm{v}^2_2} $,
$H\coloneqq I-\gamma vv^T$ ortogonalna;

\entry
$H_m \cdots H_1 A = R$, $Q \coloneqq H_1 \cdots H_m$;
% Własności przekształcenia Householdera.
\entry
$H=H{-1}=H^T$;

\entry
Obliczanie $y=Qz$:
$y=z; \mathrm{for}(i=m,\ldots 1)\{y=H_iy\}$;

\entry
Koszt rozkładu QR met. Householdera: $T(n,m)=2m^2n - \frac{2}{3}m^3$;

\entry
Układ równań normalnych:
$A^TAx=A^Tb$;

% TODO: Obrót Givensa.

% TODO: Rozkład QR macierzy Hassenberga.

% Rozkład SVD.
\entry
Rozkład SVD:
$\forall A \in \mathbb{R}^{n\times m}, n \geq m \exists A=U_1\Sigma_1V^T$, gdzie
$U_1^TU_1=V^TV=I$,
$\Sigma_1 = \mathrm{diag}(\sigma_i)$, gdzie
% TODO: Dodać brakujące założenia dotyczące wartości szczególnych.
$\sigma_i \geq 0$ to wart. szczególna $A$;

\entry
Fakt:
$A=A^T$, to mamy $A=U\Delta U^T$, gdzie $U$ to w. wł. $A$,
$\Delta= \mathrm{diag}(\lambda_i)$.
Wtedy SVD dla $A$ to $A=U\Sigma V^T$, gdzie
$\sigma_i=\abs{\lambda_i}, v_i=\mathrm{sign}(\lambda_i)u_i$;

\entry
Fakt:
W. wł. $A^TA$ to $\sigma_i^2,\ldots,\sigma_m^2$ i $(n-m)$ zer;

\entry
Tw.:
$A$ pełnego rzędu, to rozwiązaniem LZNK jest $x=V\Sigma_1^{-1}U_1^Tb$;

% TODO: Nieregularne zadanie LZNK dla rank(A) < m.
